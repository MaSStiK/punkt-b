<script>
    // Получем сохраненные данные
    let userData = JSON.parse(localStorage.getItem("userData"))

    if (userData === null) {
        location.href = "../login"
    }

    // Если нету логина или пароля или secret, перекидывает на вход
    if (!userData.hasOwnProperty("login") || !userData.hasOwnProperty("password") || !userData.hasOwnProperty("secret")) {
        localStorage.removeItem("userData")
        location.href = "../login"
    }

    if (userData?.secret === "") {
        location.href = "../cabinet"
    }
</script>

<script>
    function GSapiCabinet(action, data, func) {
        // Ссылка на скрипт Google API (Cabinet)
        const GoogleSheetURL = "https://script.google.com/macros/s/AKfycbxScyYztbrJkzzd2q5Ol7vhijll9KrSoYhMFaKOeWYXRp1rNvPZ2b8zr8f4ebvItfEolw/exec"
        $.ajax({
            crossDomain: true,
            url: GoogleSheetURL + "?action=" + action,
            method: "GET",
            dataType: 'JSONP',
            data: data,
            success: func
        })
    }


    function GSapiAdmin(action, data, func) {
        // Ссылка на скрипт Google API (Admin)
        const GoogleSheetURL = "https://script.google.com/macros/s/AKfycbyiz3I-L6kK1Ptl1mllIFnlMXKinwofTLLFLgUhxA6s5NxyaXIy0IGwpGZhmXMZbAL99A/exec"
        $.ajax({
            crossDomain: true,
            url: GoogleSheetURL + "?action=" + action,
            method: "GET",
            dataType: 'JSONP',
            data: data,
            success: func
        })
    }


    // ----------GSapiCabinet----------
    // Функиия получения всех тестирований
    function GSgetDiagnostics(func) {
        GSapiCabinet("getDiagnostics", {}, func)
    }


    // ----------GSapiAdmin----------
    // Получить актуальную информацию о профиле
     function GSgetAdminData(data, func) {
        GSapiAdmin("getAdminData", data, func)
    }    

    // Обновить информацию о админе
    function GSchangeAdminData(data, func) {
        GSapiAdmin("changeAdminData", data, func)
    }

    // Получить актуальную информацию о всех менеджерах
    function GSgetAllManagers(data, func) {
        GSapiAdmin("getAllManagers", data, func)
    }

    // Получить актуальную информацию о всех клиентах
    function GSgetAllClients(data, func) {
        GSapiAdmin("getAllClients", data, func)
    }

    // Получить актуальную информацию о всех клиентах
    function GSaddManager(data, func) {
        GSapiAdmin("addManager", data, func)
    }
</script>